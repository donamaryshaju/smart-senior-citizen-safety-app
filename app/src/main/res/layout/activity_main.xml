<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#FFFFFF"
    tools:context=".activity.SeniorDashActivity">

    <!-- HEADER with Curved Blue Gradient -->
    <View
        android:id="@+id/view_header_bg"
        android:layout_width="match_parent"
        android:layout_height="260dp"
        android:background="@drawable/bg_header_curved"
        app:layout_constraintTop_toTopOf="parent" />

    <TextView
        android:id="@+id/text_welcome_label"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginStart="24dp"
        android:layout_marginTop="48dp"
        android:text="Welcome,"
        android:textColor="#546E7A"
        android:textSize="18sp"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toTopOf="parent" />

    <TextView
        android:id="@+id/text_welcome_senior"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginStart="24dp"
        android:layout_marginTop="4dp"
        android:text="Hello, Senior"
        android:textColor="#0D47A1"
        android:textSize="32sp"
        android:textStyle="bold"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toBottomOf="@id/text_welcome_label" />

    <!-- ACTION ICONS: Notification, Settings, Logout -->
    
    <!-- Logout -->
    <ImageView
        android:id="@+id/btn_logout_senior"
        android:layout_width="28dp"
        android:layout_height="28dp"
        android:layout_marginEnd="24dp"
        android:layout_marginTop="56dp"
        android:src="@android:drawable/ic_lock_power_off"
        app:tint="#D32F2F"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintTop_toTopOf="parent" />

    <!-- Settings -->
    <ImageView
        android:id="@+id/btn_settings"
        android:layout_width="28dp"
        android:layout_height="28dp"
        android:layout_marginEnd="16dp"
        android:layout_marginTop="56dp"
        android:src="@drawable/ic_settings_gear"
        app:layout_constraintEnd_toStartOf="@id/btn_logout_senior"
        app:layout_constraintTop_toTopOf="parent" />

    <!-- Notifications with Badge -->
    <FrameLayout
        android:id="@+id/layout_notifications"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginEnd="16dp"
        android:layout_marginTop="56dp"
        app:layout_constraintEnd_toStartOf="@id/btn_settings"
        app:layout_constraintTop_toTopOf="parent">
        
        <ImageView
            android:layout_width="28dp"
            android:layout_height="28dp"
            android:src="@drawable/ic_notification_bell" />

        <TextView
            android:id="@+id/badge_notification"
            android:layout_width="16dp"
            android:layout_height="16dp"
            android:layout_gravity="top|end"
            android:background="@drawable/bg_sos_red_circle"
            android:gravity="center"
            android:text="3"
            android:textColor="#FFFFFF"
            android:textSize="10sp"
            android:textStyle="bold" />
    </FrameLayout>


    <!-- ACTIVE REQUEST BANNER (Green Card) -->
    <!-- Initially Visible for Demo -->
    <com.google.android.material.card.MaterialCardView
        android:id="@+id/card_active_request"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginHorizontal="24dp"
        android:layout_marginTop="24dp"
        app:cardBackgroundColor="#E8F5E9"
        app:cardCornerRadius="16dp"
        app:cardElevation="4dp"
        app:layout_constraintTop_toBottomOf="@id/text_welcome_senior"
        app:strokeColor="#4CAF50"
        app:strokeWidth="1dp">

        <androidx.constraintlayout.widget.ConstraintLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:padding="16dp">

            <TextView
                android:id="@+id/text_active_type"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Grocery Delivery"
                android:textColor="#2E7D32"
                android:textSize="18sp"
                android:textStyle="bold"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toTopOf="parent" />

            <TextView
                android:id="@+id/text_active_status"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginTop="4dp"
                android:text="Volunteer Assigned"
                android:textColor="#1B5E20"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@id/text_active_type" />

            <TextView
                android:id="@+id/text_active_eta"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginTop="4dp"
                android:text="ETA: 20 mins"
                android:textColor="#F57C00"
                android:textStyle="bold"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@id/text_active_status" />

            <Button
                android:id="@+id/btn_view_active_details"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginTop="8dp"
                android:backgroundTint="#4CAF50"
                android:text="Details"
                android:textSize="12sp"
                android:minHeight="40dp"
                app:layout_constraintEnd_toEndOf="parent"
                app:layout_constraintTop_toTopOf="parent"
                app:layout_constraintBottom_toBottomOf="parent" />

        </androidx.constraintlayout.widget.ConstraintLayout>
    </com.google.android.material.card.MaterialCardView>

    <!-- SOS BUTTON (Smaller now to fit) -->
    <!-- SOS BUTTON REMOVED (Duplicate) -->
    
    <!-- Removing specific SOS Glow for layout compactness if needed, or keep it behind -->
    <!-- For this dense UI, a simple SOS button on right might be better, OR center it below header -->
    <!-- User requirement: "Keep Large SOS Button". But also "Add Recent Requests". Space is tight. -->
    <!-- I will put SOS back in center but smaller, between Header and Services. -->

    <!-- RE-ADJUSTING LAYOUT -->
    <!-- The Active Banner takes space. Services need space. Recent List needs space. -->
    <!-- Creating scrollable content container -->

    <androidx.core.widget.NestedScrollView
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:fillViewport="true"
        app:layout_constraintBottom_toTopOf="@id/bottom_nav"
        app:layout_constraintTop_toBottomOf="@id/view_header_bg">

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:paddingBottom="80dp">

            <!-- "What do you need?" -->
            <TextView
                android:id="@+id/text_prompt"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginStart="24dp"
                android:layout_marginTop="16dp"
                android:text="What do you need?"
                android:textColor="#212121"
                android:textSize="20sp"
                android:textStyle="bold" />

            <!-- SERVICE GRID -->
            <GridLayout
                android:id="@+id/grid_services"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginHorizontal="16dp"
                android:layout_marginTop="8dp"
                android:alignmentMode="alignMargins"
                android:columnCount="2"
                android:rowCount="2"
                android:useDefaultMargins="true">

                <!-- Medical -->
                <com.google.android.material.card.MaterialCardView
                    android:id="@+id/card_medical"
                    android:layout_width="0dp"
                    android:layout_height="90dp"
                    android:layout_columnWeight="1"
                    android:layout_margin="8dp"
                    app:cardBackgroundColor="#E3F2FD"
                    app:cardCornerRadius="16dp"
                    app:cardElevation="2dp">
                    <LinearLayout android:layout_width="match_parent" android:layout_height="match_parent" android:gravity="center" android:orientation="vertical">
                        <ImageView android:layout_width="28dp" android:layout_height="28dp" android:src="@drawable/ic_medical" app:tint="#1976D2" />
                        <TextView android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="4dp" android:text="Medical" android:textColor="#0D47A1" android:textStyle="bold" />
                    </LinearLayout>
                </com.google.android.material.card.MaterialCardView>

                <!-- Groceries -->
                <com.google.android.material.card.MaterialCardView
                    android:id="@+id/card_grocery"
                    android:layout_width="0dp"
                    android:layout_height="90dp"
                    android:layout_columnWeight="1"
                    android:layout_margin="8dp"
                    app:cardBackgroundColor="#E8F5E9"
                    app:cardCornerRadius="16dp"
                    app:cardElevation="2dp">
                    <LinearLayout android:layout_width="match_parent" android:layout_height="match_parent" android:gravity="center" android:orientation="vertical">
                        <ImageView android:layout_width="28dp" android:layout_height="28dp" android:src="@drawable/ic_grocery" app:tint="#388E3C" />
                        <TextView android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="4dp" android:text="Groceries" android:textColor="#1B5E20" android:textStyle="bold" />
                    </LinearLayout>
                </com.google.android.material.card.MaterialCardView>

               <!-- Transport -->
                <com.google.android.material.card.MaterialCardView
                    android:id="@+id/card_transport"
                    android:layout_width="0dp"
                    android:layout_height="90dp"
                    android:layout_columnWeight="1"
                    android:layout_margin="8dp"
                    app:cardBackgroundColor="#FFF3E0"
                    app:cardCornerRadius="16dp"
                    app:cardElevation="2dp">
                    <LinearLayout android:layout_width="match_parent" android:layout_height="match_parent" android:gravity="center" android:orientation="vertical">
                        <ImageView android:layout_width="28dp" android:layout_height="28dp" android:src="@drawable/ic_transport" app:tint="#F57C00" />
                        <TextView android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="4dp" android:text="Transport" android:textColor="#E65100" android:textStyle="bold" />
                    </LinearLayout>
                </com.google.android.material.card.MaterialCardView>

                <!-- Home Care -->
                <com.google.android.material.card.MaterialCardView
                    android:id="@+id/card_homecare"
                    android:layout_width="0dp"
                    android:layout_height="90dp"
                    android:layout_columnWeight="1"
                    android:layout_margin="8dp"
                    app:cardBackgroundColor="#F3E5F5"
                    app:cardCornerRadius="16dp"
                    app:cardElevation="2dp">
                    <LinearLayout android:layout_width="match_parent" android:layout_height="match_parent" android:gravity="center" android:orientation="vertical">
                        <ImageView android:layout_width="28dp" android:layout_height="28dp" android:src="@drawable/ic_home_care" app:tint="#8E24AA" />
                        <TextView android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="4dp" android:text="Home Care" android:textColor="#4A148C" android:textStyle="bold" />
                    </LinearLayout>
                </com.google.android.material.card.MaterialCardView>
            </GridLayout>


            <!-- RECENT REQUESTS SECTION -->
            <RelativeLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginHorizontal="24dp"
                android:layout_marginTop="16dp">

                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="Recent Requests (3)"
                    android:textSize="16sp"
                    android:textStyle="bold"
                    android:textColor="#37474F" />

                <TextView
                    android:id="@+id/btn_view_all_requests"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_alignParentEnd="true"
                    android:text="View All"
                    android:textColor="#1976D2"
                    android:textStyle="bold" />
            </RelativeLayout>

            <androidx.recyclerview.widget.RecyclerView
                android:id="@+id/recycler_recent_requests"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginHorizontal="16dp"
                android:layout_marginTop="8dp"
                android:nestedScrollingEnabled="false" />

        </LinearLayout>
    </androidx.core.widget.NestedScrollView>

    <!-- Floating SOS Button or View anchored to Header -->
    <!-- The user wanted "Large SOS Button". Placing it inside ScrollView or anchored?
         Original design had it anchored.
         Let's keep the SOS Button anchored overlapping header and content for that 'Pop' effect -->
    
    <TextView
        android:id="@+id/btn_sos_floating"
        android:layout_width="120dp"
        android:layout_height="120dp"
        android:background="@drawable/bg_sos_red_circle"
        android:gravity="center"
        android:text="SOS"
        android:textColor="#FFFFFF"
        android:textSize="32sp"
        android:textStyle="bold"
        android:elevation="12dp"
        app:layout_constraintBottom_toBottomOf="@id/view_header_bg"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toBottomOf="@id/view_header_bg" />

    <!-- HIDDEN IDs Compatibility -->
    <TextView android:id="@+id/text_time" android:layout_width="0dp" android:layout_height="0dp" android:visibility="gone"/>
    <View android:id="@+id/label_active" android:layout_width="0dp" android:layout_height="0dp" android:visibility="gone"/>
    <TextView android:id="@+id/btn_profile_hidden" android:layout_width="0dp" android:layout_height="0dp" android:visibility="gone"/>
    <View android:id="@+id/layout_profile" android:layout_width="0dp" android:layout_height="0dp" android:visibility="gone"/>


    <!-- Bottom Navigation -->
    <com.google.android.material.bottomnavigation.BottomNavigationView
        android:id="@+id/bottom_nav"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="#FFFFFF"
        app:labelVisibilityMode="labeled"
        app:layout_constraintBottom_toBottomOf="parent"
        app:menu="@menu/bottom_nav_menu_senior" />

</androidx.constraintlayout.widget.ConstraintLayout>
